(function(t){var e={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},n=e[typeof window]&&window||this,r=e[typeof exports]&&exports&&!exports.nodeType&&exports,o=e[typeof module]&&module&&!module.nodeType&&module,i=(o&&o.exports===r&&r,e[typeof global]&&global);!i||i.global!==i&&i.window!==i||(n=i),"function"==typeof define&&define.amd?define(["rx","exports"],function(e,r){return n.Rx=t(n,r,e),n.Rx}):"object"==typeof module&&module&&module.exports===r?module.exports=t(n,module.exports,require("./rx")):n.Rx=t(n,{},n.Rx)}).call(this,function(t,e,n){function r(){if(this.isDisposed)throw Error(y)}var o=n.Observable,i=o.prototype,s=n.AnonymousObservable,u=n.Subject,c=n.AsyncSubject,a=n.Observer,l=n.internals.ScheduledObserver,h=n.Disposable.create,f=n.Disposable.empty,p=n.CompositeDisposable,d=n.Scheduler.currentThread,v=n.helpers.isFunction,b=n.internals.inherits,m=n.internals.addProperties,y="Object has been disposed";i.multicast=function(t,e){var n=this;return"function"==typeof t?new s(function(r){var o=n.multicast(t());return new p(e(o).subscribe(r),o.connect())}):new x(n,t)},i.publish=function(t){return t&&v(t)?this.multicast(function(){return new u},t):this.multicast(new u)},i.share=function(){return this.publish().refCount()},i.publishLast=function(t){return t&&v(t)?this.multicast(function(){return new c},t):this.multicast(new c)},i.publishValue=function(t,e){return 2===arguments.length?this.multicast(function(){return new g(e)},t):this.multicast(new g(t))},i.shareValue=function(t){return this.publishValue(t).refCount()},i.replay=function(t,e,n,r){return t&&v(t)?this.multicast(function(){return new E(e,n,r)},t):this.multicast(new E(e,n,r))},i.shareReplay=function(t,e,n){return this.replay(null,t,e,n).refCount()};var w=function(t,e){this.subject=t,this.observer=e};w.prototype.dispose=function(){if(!this.subject.isDisposed&&null!==this.observer){var t=this.subject.observers.indexOf(this.observer);this.subject.observers.splice(t,1),this.observer=null}};var g=n.BehaviorSubject=function(t){function e(t){if(r.call(this),!this.isStopped)return this.observers.push(t),t.onNext(this.value),new w(this,t);var e=this.exception;return e?t.onError(e):t.onCompleted(),f}function n(n){t.call(this,e),this.value=n,this.observers=[],this.isDisposed=!1,this.isStopped=!1,this.exception=null}return b(n,t),m(n.prototype,a,{hasObservers:function(){return this.observers.length>0},onCompleted:function(){if(r.call(this),!this.isStopped){this.isStopped=!0;for(var t=0,e=this.observers.slice(0),n=e.length;n>t;t++)e[t].onCompleted();this.observers=[]}},onError:function(t){if(r.call(this),!this.isStopped){this.isStopped=!0,this.exception=t;for(var e=0,n=this.observers.slice(0),o=n.length;o>e;e++)n[e].onError(t);this.observers=[]}},onNext:function(t){if(r.call(this),!this.isStopped){this.value=t;for(var e=0,n=this.observers.slice(0),o=n.length;o>e;e++)n[e].onNext(t)}},dispose:function(){this.isDisposed=!0,this.observers=null,this.value=null,this.exception=null}}),n}(o),E=n.ReplaySubject=function(t){function e(t,e){return h(function(){e.dispose(),!t.isDisposed&&t.observers.splice(t.observers.indexOf(e),1)})}function n(t){var n=new l(this.scheduler,t),o=e(this,n);r.call(this),this._trim(this.scheduler.now()),this.observers.push(n);for(var i=this.q.length,s=0,u=this.q.length;u>s;s++)n.onNext(this.q[s].value);return this.hasError?(i++,n.onError(this.error)):this.isStopped&&(i++,n.onCompleted()),n.ensureActive(i),o}function o(e,r,o){this.bufferSize=null==e?Number.MAX_VALUE:e,this.windowSize=null==r?Number.MAX_VALUE:r,this.scheduler=o||d,this.q=[],this.observers=[],this.isStopped=!1,this.isDisposed=!1,this.hasError=!1,this.error=null,t.call(this,n)}return b(o,t),m(o.prototype,a,{hasObservers:function(){return this.observers.length>0},_trim:function(t){for(;this.q.length>this.bufferSize;)this.q.shift();for(;this.q.length>0&&t-this.q[0].interval>this.windowSize;)this.q.shift()},onNext:function(t){if(r.call(this),!this.isStopped){var e=this.scheduler.now();this.q.push({interval:e,value:t}),this._trim(e);for(var n=this.observers.slice(0),o=0,i=n.length;i>o;o++){var s=n[o];s.onNext(t),s.ensureActive()}}},onError:function(t){if(r.call(this),!this.isStopped){this.isStopped=!0,this.error=t,this.hasError=!0;var e=this.scheduler.now();this._trim(e);for(var n=this.observers.slice(0),o=0,i=n.length;i>o;o++){var s=n[o];s.onError(t),s.ensureActive()}this.observers=[]}},onCompleted:function(){if(r.call(this),!this.isStopped){this.isStopped=!0;var t=this.scheduler.now();this._trim(t);for(var e=this.observers.slice(0),n=0,o=e.length;o>n;n++){var i=e[n];i.onCompleted(),i.ensureActive()}this.observers=[]}},dispose:function(){this.isDisposed=!0,this.observers=null}}),o}(o),x=n.ConnectableObservable=function(t){function e(e,n){var r,o=!1,i=e.asObservable();this.connect=function(){return o||(o=!0,r=new p(i.subscribe(n),h(function(){o=!1}))),r},t.call(this,n.subscribe.bind(n))}return b(e,t),e.prototype.refCount=function(){var t,e=0,n=this;return new s(function(r){var o=1===++e,i=n.subscribe(r);return o&&(t=n.connect()),function(){i.dispose(),0===--e&&t.dispose()}})},e}(o);return n});