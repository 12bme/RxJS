/* Copyright (c) Microsoft Open Technologies, Inc. All rights reserved. See License.txt in the project root for license information.*/
(function(a){var b={"function":!0,object:!0},c=b[typeof exports]&&exports&&!exports.nodeType&&exports,d=b[typeof self]&&self.Object&&self,e=b[typeof window]&&window&&window.Object&&window,f=b[typeof module]&&module&&!module.nodeType&&module,g=(f&&f.exports===c&&c,c&&f&&"object"==typeof global&&global&&global.Object&&global),h=h=g||e!==(this&&this.window)&&e||d||this;"function"==typeof define&&define.amd?define(["./rx.core"],function(b,c){return a(h,c,b)}):"object"==typeof module&&module&&module.exports===c?module.exports=a(h,module.exports,require("./rx.core")):h.Rx=a(h,{},h.Rx)}).call(this,function(a,b,c,d){function e(a){var b=[];if(!_(a))return b;$.nonEnumArgs&&a.length&&aa(a)&&(a=slice.call(a));var c=$.enumPrototypes&&"function"==typeof a,d=$.enumErrorProps&&(a===U||a instanceof Error);for(var e in a)c&&"prototype"==e||d&&("message"==e||"name"==e)||b.push(e);if($.nonEnumShadows&&a!==V){var f=a.constructor,g=-1,h=G;if(a===(f&&f.prototype))var i=a===W?Q:a===U?L:R.call(a),j=Z[i];for(;++g<h;)e=F[g],j&&j[e]||!S.call(a,e)||b.push(e)}return b}function f(a,b,c){for(var d=-1,e=c(a),f=e.length;++d<f;){var g=e[d];if(b(a[g],g,a)===!1)break}return a}function g(a,b){return f(a,b,e)}function h(a){return"function"!=typeof a.toString&&"string"==typeof(a+"")}function i(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;var e=typeof a,f=typeof b;if(a===a&&(null==a||null==b||"function"!=e&&"object"!=e&&"function"!=f&&"object"!=f))return!1;var j=R.call(a),k=R.call(b);if(j==H&&(j=O),k==H&&(k=O),j!=k)return!1;switch(j){case J:case K:return+a==+b;case N:return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case P:case Q:return a==String(b)}var l=j==I;if(!l){if(j!=O||!$.nodeClass&&(h(a)||h(b)))return!1;var m=!$.argsObject&&aa(a)?Object:a.constructor,n=!$.argsObject&&aa(b)?Object:b.constructor;if(!(m==n||S.call(a,"constructor")&&S.call(b,"constructor")||isFunction(m)&&m instanceof m&&isFunction(n)&&n instanceof n||!("constructor"in a&&"constructor"in b)))return!1}c||(c=[]),d||(d=[]);for(var o=c.length;o--;)if(c[o]==a)return d[o]==b;var p=0,q=!0;if(c.push(a),d.push(b),l){if(o=a.length,p=b.length,q=p==o)for(;p--;){var r=b[p];if(!(q=i(a[p],r,c,d)))break}}else g(b,function(b,e,f){return S.call(f,e)?(p++,q=S.call(a,e)&&i(a[e],b,c,d)):void 0}),q&&g(a,function(a,b,c){return S.call(c,b)?q=--p>-1:void 0});return c.pop(),d.pop(),q}function j(a,b){this.id=a,this.value=b}function k(a){this.predicate=a}function l(a){this.predicate=a}function m(a,b){var c=this;this.scheduler=a,this.messages=b,this.subscriptions=[],this.observers=[];for(var d=0,e=this.messages.length;e>d;d++){var f=this.messages[d],g=f.value;!function(b){a.scheduleAbsolute(null,f.time,function(){for(var a=c.observers.slice(0),d=0,e=a.length;e>d;d++)b.accept(a[d]);return r})}(g)}}var n,o=c.Observer,p=c.Observable,q=c.Disposable,r=q.empty,s=q.create,t=c.CompositeDisposable,u=c.SingleAssignmentDisposable,v=c.Scheduler,w=c.internals.ScheduledItem,x=c.internals.SchedulePeriodicRecursive,y=c.internals.inherits,z=c.helpers.notImplemented,A=c.helpers.defaultComparer=function(a,b){return ba(a,b)},B=c.Notification=function(){function a(){}return a.prototype._accept=function(a,b,c){throw new NotImplementedError},a.prototype._acceptObservable=function(a,b,c){throw new NotImplementedError},a.prototype.accept=function(a,b,c){return a&&"object"==typeof a?this._acceptObservable(a):this._accept(a,b,c)},a.prototype.toObservable=function(a){var b=this;return isScheduler(a)||(a=immediateScheduler),new AnonymousObservable(function(c){return a.schedule(b,function(a,b){b._acceptObservable(c),"N"===b.kind&&c.onCompleted()})})},a}(),C=function(a){function b(a){this.value=a,this.kind="N"}return y(b,a),b.prototype._accept=function(a){return a(this.value)},b.prototype._acceptObservable=function(a){return a.onNext(this.value)},b.prototype.toString=function(){return"OnNext("+this.value+")"},b}(B),D=function(a){function b(a){this.error=a,this.kind="E"}return y(b,a),b.prototype._accept=function(a,b){return b(this.error)},b.prototype._acceptObservable=function(a){return a.onError(this.error)},b.prototype.toString=function(){return"OnError("+this.error+")"},b}(B),E=function(a){function b(){this.kind="C"}return y(b,a),b.prototype._accept=function(a,b,c){return c()},b.prototype._acceptObservable=function(a){return a.onCompleted()},b.prototype.toString=function(){return"OnCompleted()"},b}(B),F=(B.createOnNext=function(a){return new C(a)},B.createOnError=function(a){return new D(a)},B.createOnCompleted=function(){return new E},["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]),G=F.length,H="[object Arguments]",I="[object Array]",J="[object Boolean]",K="[object Date]",L="[object Error]",M="[object Function]",N="[object Number]",O="[object Object]",P="[object RegExp]",Q="[object String]",R=Object.prototype.toString,S=Object.prototype.hasOwnProperty,T=R.call(arguments)==H,U=Error.prototype,V=Object.prototype,W=String.prototype,X=V.propertyIsEnumerable;try{n=!(R.call(document)==O&&!({toString:0}+""))}catch(Y){n=!0}var Z={};Z[I]=Z[K]=Z[N]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},Z[J]=Z[Q]={constructor:!0,toString:!0,valueOf:!0},Z[L]=Z[M]=Z[P]={constructor:!0,toString:!0},Z[O]={constructor:!0};var $={};!function(){var a=function(){this.x=1},b=[];a.prototype={valueOf:1,y:1};for(var c in new a)b.push(c);for(c in arguments);$.enumErrorProps=X.call(U,"message")||X.call(U,"name"),$.enumPrototypes=X.call(a,"prototype"),$.nonEnumArgs=0!=c,$.nonEnumShadows=!/valueOf/.test(b)}(1);var _=c.internals.isObject=function(a){var b=typeof a;return a&&("function"==b||"object"==b)||!1},aa=function(a){return a&&"object"==typeof a?R.call(a)==H:!1};T||(aa=function(a){return a&&"object"==typeof a?S.call(a,"callee"):!1});var ba=c.internals.isEqual=function(a,b){return i(a,b,[],[])},x=c.internals.SchedulePeriodicRecursive=function(){function a(a,b){b(0,this._period);try{this._state=this._action(this._state)}catch(c){throw this._cancel.dispose(),c}}function b(a,b,c,d){this._scheduler=a,this._state=b,this._period=c,this._action=d}return b.prototype.start=function(){var b=new u;return this._cancel=b,b.setDisposable(this._scheduler.scheduleRecursiveFuture(0,this._period,a.bind(this))),b},b}();j.prototype.compareTo=function(a){var b=this.value.compareTo(a.value);return 0===b&&(b=this.id-a.id),b};var ca=c.internals.PriorityQueue=function(a){this.items=new Array(a),this.length=0},da=ca.prototype;da.isHigherPriority=function(a,b){return this.items[a].compareTo(this.items[b])<0},da.percolate=function(a){if(!(a>=this.length||0>a)){var b=a-1>>1;if(!(0>b||b===a)&&this.isHigherPriority(a,b)){var c=this.items[a];this.items[a]=this.items[b],this.items[b]=c,this.percolate(b)}}},da.heapify=function(a){if(+a||(a=0),!(a>=this.length||0>a)){var b=2*a+1,c=2*a+2,d=a;if(b<this.length&&this.isHigherPriority(b,d)&&(d=b),c<this.length&&this.isHigherPriority(c,d)&&(d=c),d!==a){var e=this.items[a];this.items[a]=this.items[d],this.items[d]=e,this.heapify(d)}}},da.peek=function(){return this.items[0].value},da.removeAt=function(a){this.items[a]=this.items[--this.length],this.items[this.length]=d,this.heapify()},da.dequeue=function(){var a=this.peek();return this.removeAt(0),a},da.enqueue=function(a){var b=this.length++;this.items[b]=new j(ca.count++,a),this.percolate(b)},da.remove=function(a){for(var b=0;b<this.length;b++)if(this.items[b].value===a)return this.removeAt(b),!0;return!1},ca.count=0;var ea=c.VirtualTimeScheduler=function(a){function b(b,c){this.clock=b,this.comparer=c,this.isEnabled=!1,this.queue=new ca(1024),a.call(this)}y(b,a);var c=b.prototype;return c.now=function(){return this.toAbsoluteTime(this.clock)},c.schedule=function(a,b){return this.scheduleAbsolute(a,this.clock,b)},c.scheduleFuture=function(a,b,c){var d=b instanceof Date?this.toRelativeTime(b-this.now()):this.toRelativeTime(b);return this.scheduleRelative(a,d,c)},c.add=z,c.toAbsoluteTime=z,c.toRelativeTime=z,c.schedulePeriodic=function(a,b,c){var d=new x(this,a,b,c);return d.start()},c.scheduleRelative=function(a,b,c){var d=this.add(this.clock,b);return this.scheduleAbsolute(a,d,c)},c.start=function(){if(!this.isEnabled){this.isEnabled=!0;do{var a=this.getNext();null!==a?(this.comparer(a.dueTime,this.clock)>0&&(this.clock=a.dueTime),a.invoke()):this.isEnabled=!1}while(this.isEnabled)}},c.stop=function(){this.isEnabled=!1},c.advanceTo=function(a){var b=this.comparer(this.clock,a);if(this.comparer(this.clock,a)>0)throw new ArgumentOutOfRangeError;if(0!==b&&!this.isEnabled){this.isEnabled=!0;do{var c=this.getNext();null!==c&&this.comparer(c.dueTime,a)<=0?(this.comparer(c.dueTime,this.clock)>0&&(this.clock=c.dueTime),c.invoke()):this.isEnabled=!1}while(this.isEnabled);this.clock=a}},c.advanceBy=function(a){var b=this.add(this.clock,a),c=this.comparer(this.clock,b);if(c>0)throw new ArgumentOutOfRangeError;0!==c&&this.advanceTo(b)},c.sleep=function(a){var b=this.add(this.clock,a);if(this.comparer(this.clock,b)>=0)throw new ArgumentOutOfRangeError;this.clock=b},c.getNext=function(){for(;this.queue.length>0;){var a=this.queue.peek();if(!a.isCancelled())return a;this.queue.dequeue()}return null},c.scheduleAbsolute=function(a,b,c){function d(a,b){return e.queue.remove(f),c(a,b)}var e=this,f=new w(this,a,d,b,this.comparer);return this.queue.enqueue(f),f.disposable},b}(v);k.prototype.equals=function(a){return a===this?!0:null==a?!1:"N"!==a.kind?!1:this.predicate(a.value)},l.prototype.equals=function(a){return a===this?!0:null==a?!1:"E"!==a.kind?!1:this.predicate(a.error)};var fa=c.ReactiveTest={created:100,subscribed:200,disposed:1e3,onNext:function(a,b){return"function"==typeof b?new ga(a,new k(b)):new ga(a,B.createOnNext(b))},onError:function(a,b){return"function"==typeof b?new ga(a,new l(b)):new ga(a,B.createOnError(b))},onCompleted:function(a){return new ga(a,B.createOnCompleted())},subscribe:function(a,b){return new ha(a,b)}},ga=c.Recorded=function(a,b,c){this.time=a,this.value=b,this.comparer=c||A};ga.prototype.equals=function(a){return this.time===a.time&&this.comparer(this.value,a.value)},ga.prototype.toString=function(){return this.value.toString()+"@"+this.time};var ha=c.Subscription=function(a,b){this.subscribe=a,this.unsubscribe=b||Number.MAX_VALUE};ha.prototype.equals=function(a){return this.subscribe===a.subscribe&&this.unsubscribe===a.unsubscribe},ha.prototype.toString=function(){return"("+this.subscribe+", "+(this.unsubscribe===Number.MAX_VALUE?"Infinite":this.unsubscribe)+")"};var ia=c.MockDisposable=function(a){this.scheduler=a,this.disposes=[],this.disposes.push(this.scheduler.clock)};ia.prototype.dispose=function(){this.disposes.push(this.scheduler.clock)};var ja=function(a){function b(b){a.call(this),this.scheduler=b,this.messages=[]}y(b,a);var c=b.prototype;return c.onNext=function(a){this.messages.push(new ga(this.scheduler.clock,B.createOnNext(a)))},c.onError=function(a){this.messages.push(new ga(this.scheduler.clock,B.createOnError(a)))},c.onCompleted=function(){this.messages.push(new ga(this.scheduler.clock,B.createOnCompleted()))},b}(o);m.prototype.then=function(a,b){var e=this;this.subscriptions.push(new ha(this.scheduler.clock));var f,g=this.subscriptions.length-1,h=c.Observer.create(function(b){var i=a(b);if(i&&"function"==typeof i.then)f=i;else{var j=e.scheduler.clock;f=new m(e.scheduler,[c.ReactiveTest.onNext(j,d),c.ReactiveTest.onCompleted(j)])}var k=e.observers.indexOf(h);e.observers.splice(k,1),e.subscriptions[g]=new ha(e.subscriptions[g].subscribe,e.scheduler.clock)},function(a){b(a);var c=e.observers.indexOf(h);e.observers.splice(c,1),e.subscriptions[g]=new ha(e.subscriptions[g].subscribe,e.scheduler.clock)});return this.observers.push(h),f||new m(this.scheduler,this.messages)};var ka=function(a){function b(a){var b=this;this.observers.push(a),this.subscriptions.push(new ha(this.scheduler.clock));var c=this.subscriptions.length-1;return s(function(){var d=b.observers.indexOf(a);b.observers.splice(d,1),b.subscriptions[c]=new ha(b.subscriptions[c].subscribe,b.scheduler.clock)})}function c(c,d){a.call(this,b);var e,f,g=this;this.scheduler=c,this.messages=d,this.subscriptions=[],this.observers=[];for(var h=0,i=this.messages.length;i>h;h++)e=this.messages[h],f=e.value,function(a){c.scheduleAbsolute(null,e.time,function(){for(var b=g.observers.slice(0),c=0,d=b.length;d>c;c++)a.accept(b[c]);return r})}(f)}return y(c,a),c}(p),la=function(a){function b(a){var b,c,d=this;this.subscriptions.push(new ha(this.scheduler.clock));for(var e=this.subscriptions.length-1,f=new t,g=0,h=this.messages.length;h>g;g++)b=this.messages[g],c=b.value,function(c){f.add(d.scheduler.scheduleRelative(null,b.time,function(){return c.accept(a),r}))}(c);return s(function(){d.subscriptions[e]=new ha(d.subscriptions[e].subscribe,d.scheduler.clock),f.dispose()})}function c(c,d){a.call(this,b),this.scheduler=c,this.messages=d,this.subscriptions=[]}return y(c,a),c}(p);return c.TestScheduler=function(a){function b(a,b){return a>b?1:b>a?-1:0}function d(){a.call(this,0,b)}return y(d,a),d.prototype.scheduleAbsolute=function(b,c,d){return c<=this.clock&&(c=this.clock+1),a.prototype.scheduleAbsolute.call(this,b,c,d)},d.prototype.add=function(a,b){return a+b},d.prototype.toAbsoluteTime=function(a){return new Date(a).getTime()},d.prototype.toRelativeTime=function(a){return a},d.prototype.startScheduler=function(a,b){b||(b={}),null==b.created&&(b.created=fa.created),null==b.subscribed&&(b.subscribed=fa.subscribed),null==b.disposed&&(b.disposed=fa.disposed);var c,d,e=this.createObserver();return this.scheduleAbsolute(null,b.created,function(){return c=a(),r}),this.scheduleAbsolute(null,b.subscribed,function(){return d=c.subscribe(e),r}),this.scheduleAbsolute(null,b.disposed,function(){return d.dispose(),r}),this.start(),e},d.prototype.createHotObservable=function(){var a,b=arguments.length;if(Array.isArray(arguments[0]))a=arguments[0];else{a=new Array(b);for(var c=0;b>c;c++)a[c]=arguments[c]}return new ka(this,a)},d.prototype.createColdObservable=function(){var a,b=arguments.length;if(Array.isArray(arguments[0]))a=arguments[0];else{a=new Array(b);for(var c=0;b>c;c++)a[c]=arguments[c]}return new la(this,a)},d.prototype.createResolvedPromise=function(a,b){return new m(this,[c.ReactiveTest.onNext(a,b),c.ReactiveTest.onCompleted(a)])},d.prototype.createRejectedPromise=function(a,b){return new m(this,[c.ReactiveTest.onError(a,b)])},d.prototype.createObserver=function(){return new ja(this)},d}(ea),c});
//# sourceMappingURL=rx.core.testing.map