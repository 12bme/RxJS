/* Copyright (c) Microsoft Open Technologies, Inc. All rights reserved. See License.txt in the project root for license information.*/
(function(a){var b={"function":!0,object:!0},c=b[typeof exports]&&exports&&!exports.nodeType&&exports,d=b[typeof self]&&self.Object&&self,e=b[typeof window]&&window&&window.Object&&window,f=b[typeof module]&&module&&!module.nodeType&&module,g=(f&&f.exports===c&&c,c&&f&&"object"==typeof global&&global&&global.Object&&global),h=h=g||e!==(this&&this.window)&&e||d||this;"function"==typeof define&&define.amd?define(["./rx.lite.compat"],function(b,c){return a(h,c,b)}):"object"==typeof module&&module&&module.exports===c?module.exports=a(h,module.exports,require("rx-lite-compat")):h.Rx=a(h,{},h.Rx)}).call(this,function(a,b,c,d){function e(a){return function(){try{return a.apply(this,arguments)}catch(b){return v.e=b,v}}}function f(a){return a.toArray()}function f(a){return a.toArray()}var g=(c.internals.inherits,c.internals.AbstractObserver,c.Observable),h=g.prototype,i=c.AnonymousObservable,j=g.defer,k=(g.empty,g.never,g["throw"],g.fromArray,c.Scheduler["default"]),l=c.SingleAssignmentDisposable,m=c.SerialDisposable,n=c.CompositeDisposable,o=c.BinaryDisposable,p=c.RefCountDisposable,q=c.Subject,r=c.internals.addRef,s=(c.Scheduler.normalize,c.helpers),t=(s.isPromise,s.isFunction),u=c.Scheduler.isScheduler,v=(g.fromPromise,{e:{}});c.internals.tryCatch=function(a){if(!t(a))throw new TypeError("fn must be a function");return e(a)};return h.windowWithTime=function(a,b,c){var d,e=this;return null==b&&(d=a),u(c)||(c=k),"number"==typeof b?d=b:u(b)&&(d=a,c=b),new i(function(b){function f(){var a=new l,e=!1,g=!1;o.setDisposable(a),j===i?(e=!0,g=!0):i>j?e=!0:g=!0;var m=e?j:i,n=m-s;s=m,e&&(j+=d),g&&(i+=d),a.setDisposable(c.scheduleFuture(null,n,function(){if(g){var a=new q;k.push(a),b.onNext(r(a,h))}e&&k.shift().onCompleted(),f()}))}var g,h,i=d,j=a,k=[],o=new m,s=0;return g=new n(o),h=new p(g),k.push(new q),b.onNext(r(k[0],h)),f(),g.add(e.subscribe(function(a){for(var b=0,c=k.length;c>b;b++)k[b].onNext(a)},function(a){for(var c=0,d=k.length;d>c;c++)k[c].onError(a);b.onError(a)},function(){for(var a=0,c=k.length;c>a;a++)k[a].onCompleted();b.onCompleted()})),h},e)},h.windowWithTimeOrCount=function(a,b,c){var d=this;return u(c)||(c=k),new i(function(e){function f(b){var d=new l;g.setDisposable(d),d.setDisposable(c.scheduleFuture(null,a,function(){if(b===k){j=0;var a=++k;o.onCompleted(),o=new q,e.onNext(r(o,i)),f(a)}}))}var g=new m,h=new n(g),i=new p(h),j=0,k=0,o=new q;return e.onNext(r(o,i)),f(0),h.add(d.subscribe(function(a){var c=0,d=!1;o.onNext(a),++j===b&&(d=!0,j=0,c=++k,o.onCompleted(),o=new q,e.onNext(r(o,i))),d&&f(c)},function(a){o.onError(a),e.onError(a)},function(){o.onCompleted(),e.onCompleted()})),i},d)},h.bufferWithTime=function(a,b,c){return this.windowWithTime(a,b,c).flatMap(f)},h.bufferWithTimeOrCount=function(a,b,c){return this.windowWithTimeOrCount(a,b,c).flatMap(f)},h.timeInterval=function(a){var b=this;return u(a)||(a=k),j(function(){var c=a.now();return b.map(function(b){var d=a.now(),e=d-c;return c=d,{value:b,interval:e}})})},g.generateWithAbsoluteTime=function(a,b,c,d,e,f){return u(f)||(f=k),new i(function(g){var h=!0,i=!1;return f.scheduleRecursiveFuture(a,new Date(f.now()),function(a,f){i&&g.onNext(a);try{if(h?h=!1:a=c(a),i=b(a))var j=d(a),k=e(a)}catch(l){return void g.onError(l)}i?f(j,k):g.onCompleted()})})},g.generateWithRelativeTime=function(a,b,c,d,e,f){return u(f)||(f=k),new i(function(g){var h=!0,i=!1;return f.scheduleRecursiveFuture(a,0,function(a,f){i&&g.onNext(a);try{if(h?h=!1:a=c(a),i=b(a))var j=d(a),k=e(a)}catch(l){return void g.onError(l)}i?f(j,k):g.onCompleted()})})},h.delaySubscription=function(a,b){var c=this;return u(b)||(b=k),new i(function(d){var e=new m;return e.setDisposable(b.scheduleFuture(null,a,function(){e.setDisposable(c.subscribe(d))})),e},this)},h.skipLastWithTime=function(a,b){u(b)||(b=k);var c=this;return new i(function(d){var e=[];return c.subscribe(function(c){var f=b.now();for(e.push({interval:f,value:c});e.length>0&&f-e[0].interval>=a;)d.onNext(e.shift().value)},function(a){d.onError(a)},function(){for(var c=b.now();e.length>0&&c-e[0].interval>=a;)d.onNext(e.shift().value);d.onCompleted()})},c)},h.takeLastWithTime=function(a,b){var c=this;return u(b)||(b=k),new i(function(d){var e=[];return c.subscribe(function(c){var d=b.now();for(e.push({interval:d,value:c});e.length>0&&d-e[0].interval>=a;)e.shift()},function(a){d.onError(a)},function(){for(var c=b.now();e.length>0;){var f=e.shift();c-f.interval<=a&&d.onNext(f.value)}d.onCompleted()})},c)},h.takeLastBufferWithTime=function(a,b){var c=this;return u(b)||(b=k),new i(function(d){var e=[];return c.subscribe(function(c){var d=b.now();for(e.push({interval:d,value:c});e.length>0&&d-e[0].interval>=a;)e.shift()},function(a){d.onError(a)},function(){for(var c=b.now(),f=[];e.length>0;){var g=e.shift();c-g.interval<=a&&f.push(g.value)}d.onNext(f),d.onCompleted()})},c)},h.takeWithTime=function(a,b){var c=this;return u(b)||(b=k),new i(function(d){return new o(b.scheduleFuture(d,a,function(a,b){b.onCompleted()}),c.subscribe(d))},c)},h.skipWithTime=function(a,b){var c=this;return u(b)||(b=k),new i(function(d){var e=!1;return new o(b.scheduleFuture(null,a,function(){e=!0}),c.subscribe(function(a){e&&d.onNext(a)},function(a){d.onError(a)},function(){d.onCompleted()}))},c)},h.skipUntilWithTime=function(a,b){u(b)||(b=k);var c=this;return new i(function(d){var e=!1;return new o(b.scheduleFuture(null,a,function(){e=!0}),c.subscribe(function(a){e&&d.onNext(a)},function(a){d.onError(a)},function(){d.onCompleted()}))},c)},h.takeUntilWithTime=function(a,b){u(b)||(b=k);var c=this;return new i(function(d){return new o(b.scheduleFuture(d,a,function(a,b){b.onCompleted()}),c.subscribe(d))},c)},c});
//# sourceMappingURL=rx.lite.time.compat.map